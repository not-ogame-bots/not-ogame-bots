function saveImperiumOrder(a,b){var c="impSortOrder";if(b){c="impSortOrderMoon"}$.ajax({url:saveUrl,method:"post",dataType:"json",data:{ajax:1,type:c,planets:$(a).sortable("toArray")}})}function clearImperiumOrder(){$.ajax({url:saveUrl,method:"post",dataType:"json",data:{ajax:1,type:"reset"},success:function(a){if(!a.error){location.reload()}}})}function createSummaryHtml(g){var d="";var a=null;var f=0;var c=0;var b="";d=d+'<div class="planetHead"><div class="planetname">'+g.translations.summary+'</div><div class="planetImg"><img src="//gf3.geo.gfsrv.net/cdn8a/7efb2e73ca11d2344bbed43668da10.jpg"/></div><div class="planetData"><ul><li class="coords textLeft"></li><li class="fields textRight"></li></ul></div><div class="clearfloat"/></div>';for(group in g.groups){d=d+'<div class="row" /><div class="values '+group+" group"+group+'">';for(c=0;b=g.groups[group][c];c++){if(g.translations.planets[b]==null){continue}var h={hourly:0,daily:0,weekly:0};if(b=="name"){f=g.translations.summary}else{f=0;if(group=="research"){if(!isNaN(g.planets[0][b])){f=g.planets[0][b]}}else{$.each(g.planets,function(){a=this;if(!isNaN(a[b])){f=f+parseInt(a[b]);if(group=="supply"&&!isNaN(a.production["hourly"][b-1])){h.hourly+=a.production["hourly"][b-1];h.daily+=a.production["daily"][b-1];h.weekly+=a.production["weekly"][b-1]}}})}}if(group=="supply"||group=="facilities"){f="&#x00F8; "+tsdpkt(round(f/g.planets.length,1))}else{if(group=="items"){f="&nbsp;"}else{f=tsdpkt(f)}}if(group=="supply"&&b!="name"&&h.hourly>0){var e="<table><tr><td>"+g.translations.production.hourly+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(h.hourly)+"</td></tr><tr><td>"+g.translations.production.daily+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(h.daily)+"</td></tr><tr><td>"+g.translations.production.weekly+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(h.weekly)+"</td></tr></table>";e=e.replace(/</,"&lt;").replace(/>/,"&gt;");d=d+'<div class="tooltipRight '+b+'" title="'+e+'">'+f+"</div>"}else{d=d+'<div class="'+b+'">'+f+"</div>"}}d=d+"</div>"}d='<div id="planet0" class="planet summary">'+d+"</div>";return d}function createHeaderHtml(d){var c="";var b=0;var a="";c=c+'<div id="wrapTL"><div id="tab-left"><a id="planetsTab" href="javascript:void(0);" class="active" title=""><span>'+d.translations.planetsTab+'</span></a><a id="moonsTab" href="javascript:void(0);" title="" class=""><span>'+d.translations.moonsTab+"</span></a></div></div>";for(group in d.groups){c=c+'<div id="'+group+'" class="firstCat headers '+group+" headers"+group+'" group="'+group+'"><h3 class="open"><span>'+d.translations.groups[group]+'</span></h3><ul class="secondCat '+group+" group"+group+'">';for(b=0;a=d.groups[group][b];b++){if(d.translations.planets[a]==null){continue}c+='<li class="'+a+'">';if(d.translations.planets[a+"_full"]!=d.translations.planets[a]){c+='<span class="tooltipLeft" title="'+d.translations.planets[a+"_full"]+'">'+d.translations.planets[a]+"</span>"}else{c+="<span>"+d.translations.planets[a]+"</span>"}c+="</li>"}c=c+"</ul></div>"}c='<div id="empireTab"><div class="wrapTab"><div class="tab-part01"></div><h2>'+d.translations.header+'</h2><span class="reset"><img src="//gf2.geo.gfsrv.net/cdnab/f805c477d15ae3131b7c39c7d70e48.gif" width="16" height="16"><a href="javascript:void(0);" onClick="clearImperiumOrder(); return false;">'+d.translations.reset+'</a></span><div class="wrapCorner"></div><br class="clearfloat"/></div></div><div class="header">'+c+"</div>";return c}function createPlanetsHtml(h){var c="";var d="";var g="";var a="";var b="";var f=0;var e="";$.each(h.planets,function(){c=this;g="";a="";d=(c.name.length>13)?c.name.substr(0,11)+"...":c.name;g+='<div class="planetHead">';if(c.name!=d){g+='<div class="planetname tooltip" title="'+c.name+'">'+d+"</div>"}else{g+='<div class="planetname">'+d+"</div>"}if(isMobile){g+='<div class="planetImg"><img class="'+c.border+'" src="'+c.image+'"/></div><div class="planetData"><div class="planetDataTop odd"><ul><li class="coords textLeft"><a class="dark_highlight_tablet" href="'+c.coordinatesLink+'" >'+c.coordinates+'</a></li><li class="coords"><span class="dark_highlight_tablet energy tooltipRight" title="'+(c.type==3?c.diameterTooltip:c.energyTooltip)+'">'+(c.type==3?"\u2300: "+c.diameter:c.energyDescr+c.energy)+'</span></li></ul></div><div class="planetDataTop"><ul class="planet_data_2"><li class="fields textLeft">'+c.fieldUsed+"/"+c.fieldMax+'</li><li class="fields textLeft">'+c.temperature+'</li></ul></div></div><div class="clearfloat"/></div>'}else{g+='<div class="planetImg"><img class="'+c.border+'" src="'+c.image+'"/></div><div class="planetData"><div class="planetDataTop odd"><ul><li class="coords textLeft"><a href="'+c.coordinatesLink+'" >'+c.coordinates+'</a></li><li class="fields textRight">'+c.fieldUsed+"/"+c.fieldMax+'</li></ul></div><div class="planetDataTop"><ul><li class="coords textLeft">'+(c.type==3?c.diameterDescr:c.energyDescr)+'</li><li class="coords textRight">'+(c.type==3?c.diameter:c.energy)+'</li></ul></div><div class="planetDataBottom odd"><ul><li class="fields textCenter">'+c.temperature+'</li></ul></div></div><div class="clearfloat"/></div>'}for(var i in h.groups){g=g+'<div class="row" /><div class="values '+i+" group"+i+'">';for(f=0;e=h.groups[i][f];f++){e=String(e);if(c[e+"_html"]!=null){e=e+"_html"}a=e;if(e.substring(e.length-5)=="_html"){a=e.substring(0,e.length-5)}g=g+'<div class="'+a+'">'+c[e]+"</div>"}g=g+"</div>"}b=b+'<div id="planet'+this.id+'" class="planet">'+g+"</div>"});return b}function createImperiumHtml(g,c,e,h){var a=0;if(typeof e.planets!="undefined"){a=e.planets.length}var d=345+a*165;$("#mainWrapper").attr("style","width: "+d+"px");$(c).show();var f=createHeaderHtml(e)+'<div class="planetWrapper">'+createPlanetsHtml(e)+createSummaryHtml(e)+'</div><br class="clearfloat"/>';$(g).append(f);$(g+" .planetWrapper").sortable({start:function(){removeTooltip(getTooltipSelector())},update:function(){saveImperiumOrder(g+" .planetWrapper",h)}}).disableSelection();for(group in e.groups){$(g+" .headers"+group).click(function(){var j=g+" .group"+$(this).attr("group");var k="#"+$(this).attr("group")+" h3";$(j).toggle();$(k).removeClass("openhover").removeClass("closehover").removeClass("close").removeClass("open");if($(j).attr("style").toLowerCase().substr(9,4)=="none"){$(k).addClass("close");$.cookie("impToggleState"+$(this).attr("group"),"1",{expires:365})}else{$(k).addClass("open");$.cookie("impToggleState"+$(this).attr("group"),"0",{expires:365})}});var b=$.cookie("impToggleState"+group);if(b!=null&&b=="1"){$("#"+group+" > h3").removeClass("open");$("#"+group+" > h3").addClass("close");$(g+" .group"+group).toggle()}}$(c).hide();var i=$.inArray(0,empireOrder);if(i>-1){$(".planetWrapper .planet:eq("+i+"):not(:last-child)").before($("#planet0"))}initTooltips()}function displayMessage(a){location.reload(true)}function doUpgrade(h,d,e,a,g){if(forcedToVacation){errorBoxNotify(LocalizationStrings.error,LocalizationStrings.forcedVacationWarning,LocalizationStrings.ok);return}var f={};f.modus=e;f.techid=h;f.listid=a;f.planet=d;var c=LocalizationStrings.lastSlotWarningPlanet;var b=upgradeUrl;if(e==2){b+="&token="+cancelBuildingToken}if(planetType==1){c=LocalizationStrings.lastSlotWarningMoon}if(g){errorBoxDecision(LocalizationStrings.attention,c,LocalizationStrings.yes,LocalizationStrings.no,function(){$.post(b,f,displayMessage)})}else{$.post(b,f,displayMessage)}}function initEmpire(){initConnectionErrorFunction();$(".secondCat").each(function(){$(this).find("li:last").addClass("catbox-end")});$(".values").each(function(){if(!$(this).hasClass("groupitems")){$(this).find("div:even").addClass("even");$(this).find("div:odd").addClass("odd");$(this).find("div:last").addClass("box-end")}if($(this).children().hasClass("equipment")){$(this).children(".equipment").addClass("box-end")}});$("#settings li:last").addClass("set-end");$(".header h3").hover(function(){$(this).addClass($(this).attr("class")+"hover")},function(){$(this).removeClass("openhover").removeClass("closehover")});$(".header h3").click(function(){$(this).removeClass("openhover").removeClass("closehover");var a=$(this).attr("class");if(a=="open"){$(this).addClass("close")}else{$(this).addClass("open")}$(this).removeClass(a)});$(".planet").hover(function(){$(this).addClass("move")},function(){$(this).removeClass("move")});$(".values div img").hover(function(){$(this).addClass("imghover")},function(){$(this).removeClass("imghover")});$("#planetsTab").click(function(){window.location.href=empireUrl+"&planetType=0"});if(moonCount>0){$("#moonsTab").click(function(){window.location.href=empireUrl+"&planetType=1"})}else{$("#moonsTab").addClass("nomoons")}if(planetType==1){$("#planetsTab").removeClass("active");$("#moonsTab").addClass("active")}initBuffBarEmpire()}function initBuffBarEmpire(){var a=$(".empireItems");a.anythingSlider({resizeContents:false,buildNavigation:false,buildStartStop:false,infiniteSlides:false,stopAtEnd:true});a.removeClass("hidden")};