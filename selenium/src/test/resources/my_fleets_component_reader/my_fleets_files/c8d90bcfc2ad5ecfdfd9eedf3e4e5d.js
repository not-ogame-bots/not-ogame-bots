function oldcountdown(c,a,b){if(a==null||a==""){a=2}var e=this;e.countValue=parseInt(b)||-1;e.timestamp=0;e.maxDigits=parseInt(a);e.delimiter=" ";e.approx="";e.showunits=true;e.zerofill=false;var d=new Date();e.startTime=d.getTime();e.startLeftoverTime=parseInt(c);this.getCurrentTimestring=function(){return e.formatTime(e.getLeftoverTime())};this.getLeftoverTime=function(){var f=new Date();return Math.round((e.startLeftoverTime+((f.getTime()-e.startTime)*e.countValue)/1000))};this.formatTime=function(f){return formatTimeWrapper(f,e.maxDigits,e.showunits,e.delimiter,e.zerofill,e.approx)}}function formatTimeWrapper(h,c,f,b,d,i){var j=[];j.week=604800;j.day=86400;j.hour=3600;j.minute=60;j.second=1;var a="";for(var e in j){var g=Math.floor(h/j[e]);if(c>0&&(g>0||d&&a!="")){h=h-g*j[e];if(a!=""){a+=b;if(g<10&&g>0&&d){g="0"+g}if(g==0){g="00"}}a+=g+(f?LocalizationStrings.timeunits["short"][e]:"");c--}}if(h>0){a=i+a}return a}function bauCountdown(h,d,c,b){var f=$(h);if(typeof(f)!=="object"){return}var g=this;g.totalTime=c;g.startHeight=f.offsetHeight;g.htmlObj=$(f);g.timeHtmlObj=g.htmlObj.find(".time");g.imgHtmlObj=g.htmlObj.find(".buildingimg");var e=g.imgHtmlObj.css("background-image");var a=g.imgHtmlObj.css("background-position");this.updateCountdown=function(){g.countdown.getCurrentTimestring();timestamp=g.countdown.getLeftoverTime();timestring=g.countdown.getCurrentTimestring();g.timeHtmlObj.text(timestring);var i=Math.max(0,timestamp)/g.totalTime;if(i>0){var k=100-Math.floor(i*100);var m="rgba(0, 0, 0, 0) "+(k-2)+"%";var l="rgba(0, 0, 0, 0.85) "+(k+2)+"%";g.imgHtmlObj.css({background:"linear-gradient("+m+", "+l+"), "+e+" "+a})}else{var j=new ogame.Notify(LocalizationStrings.status.ready);j.setImage($(".planetPic").attr("src"));j.show();g.timeHtmlObj.text(LocalizationStrings.status.ready);g.htmlObj.css({height:g.startHeight+"px",marginTop:0});if(timestamp<=-1&&timestamp>-6&&!isOverlayOpen()){if(b!==undefined){reload_page(b)}else{reload_page(window.location.href)}}}};if(g.timeHtmlObj.length){g.countdown=new oldcountdown(d);timerHandler.appendCallback(g.updateCountdown);g.updateCountdown()}else{window.status="kein timeHtmlObj"}}function schiffbauCountdown(e,b,g,d,c,a){if(typeof(e)!=="object"){return}var f=this;f.totalTime=c;f.oneShipTime=c;f.shipCount=b;f.currentShips=g;f.startHeight=e.offsetHeight;f.htmlObj=$(e);f.timeHtmlObj=document.getElementById("shipyardCountdown");f.countHtmlObj=$(".shipSumCount");f.shipsHtmlObj=$("#shipyardcomponent .stockAmount");this.updateCountdown=function(){f.countdown.getCurrentTimestring();timestamp=f.countdown.getLeftoverTime();timestring=f.countdown.getCurrentTimestring();$("#shipyardCountdown").text(timestring);var i=Math.max(0,timestamp)/f.totalTime;if(i>0){var h=Math.round(f.startHeight*i);f.htmlObj.css({height:h+"px",marginTop:(f.startHeight-h)+"px"})}else{if(f.shipCount>0){f.shipCount--;f.currentShips++}if(f.shipCount>=0){f.countHtmlObj.text(f.shipCount);$(".shipSumCount").text(f.shipCount)}f.shipsHtmlObj.text(gfNumberGetHumanReadable(f.currentShips));if(f.shipCount>0){f.countdown=new oldcountdown(c);$("#shipyardCountdown").text("-")}else{if(timestamp<=-1&&timestamp>-6){if(a!=null&&!isOverlayOpen()){reload_page(a)}timerHandler.removeCallback(f.timer)}$("#shipyardCountdown").text(LocalizationStrings.status.ready)}}};if(f.timeHtmlObj&&f.countHtmlObj&&f.shipsHtmlObj){totalTime=Math.floor(b*c);f.countdown=new oldcountdown(d);f.timer=timerHandler.appendCallback(f.updateCountdown);f.updateCountdown()}else{window.status="kein: timeHtmlObj oder countHtmlObj oder shipsHtmlObj"}}function baulisteCountdown(g,c,b,e,a){var d=$(g);if(typeof(d)!=="object"){return}var f=this;f.timeHtmlObj=d;f.updateCountdown=function(h){var i=f.countdown.getLeftoverTime();if(i>0){f.timeHtmlObj.html(f.countdown.getCurrentTimestring());$(h).html(f.countdown.getCurrentTimestring())}else{f.timeHtmlObj.html(LocalizationStrings.status.ready);$(h).html(LocalizationStrings.status.ready);if(typeof(e)=="function"){e()}if(i<=-1&&i>-6){if(b!=null&&!isOverlayOpen()){reload_page(b)}timerHandler.removeCallback(f.timer)}}};if(f.timeHtmlObj){f.countdown=new oldcountdown(c,3);f.timer=timerHandler.appendCallback(function(){f.updateCountdown(a)});f.updateCountdown(a)}}function eventboxCountdown(e,c,a,d,b){if(typeof(e)!=="object"){return}var f=this;f.timeHtmlObj=e;this.updateCountdown=function(){f.countdown.getCurrentTimestring();var h=f.countdown.getLeftoverTime();var g=f.countdown.getCurrentTimestring();if(h>0){$(f.timeHtmlObj).html(g)}else{timerHandler.removeCallback(f.timer);$(f.timeHtmlObj).html(LocalizationStrings.status.ready);if(!timerHandler.checkEventsAlreadyQueued){timerHandler.checkEventsAlreadyQueued=true;setTimeout(function(){$.post(d,{ids:b},function(k){var i=$.parseJSON(k);for(var j in i.rows){$(a).find("#eventRow-"+i.rows[j]).remove();$(".union"+i.rows[j]).remove()}$(".eventFleet").removeClass("odd");$(".partnerInfo").removeClass("part-even");$(".eventFleet:odd").addClass("odd");$(".partnerInfo:even").addClass("part-even");timerHandler.checkEventsAlreadyQueued=false})},2500)}}};if(f.timeHtmlObj){f.countdown=new oldcountdown(c,3);f.timer=timerHandler.appendCallback(f.updateCountdown);f.updateCountdown()}}function simpleCountdown(d,a,c,b){if(typeof(d)!=="object"){return}var e=this;e.timeHtmlObj=$(d)[0];this.updateCountdown=function(){var g=e.countdownObject.getLeftoverTime();var f=e.countdownObject.getCurrentTimestring();if(g>0){$("#"+e.timeHtmlObj.id).text(f);if(typeof b=="string"&&$.isFunction(window[b])){window[b]()}else{if($.isFunction(b)){b()}}}else{timerHandler.removeCallback(e.timer);$("#"+e.timeHtmlObj.id).text(LocalizationStrings.status.ready);if(typeof c=="string"&&$.isFunction(window[c])){window[c]()}else{if($.isFunction(c)){c()}}}};if(typeof(e.timer)!="undefined"){timerHandler.removeCallback(e.timer)}if(e.timeHtmlObj){e.countdownObject=new oldcountdown(a,3);e.timer=timerHandler.appendCallback(e.updateCountdown);e.updateCountdown()}}function countdownWithTickFunction(f,c,b,e,d,a){if(typeof(f)!=="object"){return}var g=this;g.timeHtmlObj=f;if(typeof($(f).attr("data-oldcountdown"))!="undefined"){timerHandler.removeCallback($(f).attr("data-oldcountdown"))}this.updateCountdown=function(){timestamp=g.countdown.getLeftoverTime();timestring=g.countdown.getCurrentTimestring();if(timestamp>0){g.timeHtmlObj.innerHTML=timestring;if(typeof d=="string"&&$.isFunction(window[d])){window[d](timestamp,b)}else{if($.isFunction(d)){d(timestamp,b)}}}else{timerHandler.removeCallback(g.timer);g.timeHtmlObj.innerHTML=LocalizationStrings.status.ready;if(typeof e=="string"&&$.isFunction(window[e])){window[e]()}else{if($.isFunction(e)){e()}}}};if(g.timeHtmlObj){g.countdown=new oldcountdown(c,a);g.timer=timerHandler.appendCallback(g.updateCountdown);g.updateCountdown();$(f).attr("data-oldcountdown",g.timer)}return g}function reloadCountdown(c,b,a){if(typeof(c)!=="object"){return}var d=this;d.timeHtmlObj=c;this.updateCountdown=function(){d.countdown.getCurrentTimestring();timestamp=d.countdown.getLeftoverTime();timestring=d.countdown.getCurrentTimestring();if(timestamp>0){d.timeHtmlObj.innerHTML=timestring}else{d.timeHtmlObj.innerHTML=LocalizationStrings.status.ready;if(timestamp<=-2&&timestamp>-6&&!isOverlayOpen()){reload_page(a)}}};if(d.timeHtmlObj){d.countdown=new oldcountdown(b,3);timerHandler.appendCallback(d.updateCountdown);d.updateCountdown()}}function movementImageCountdown(f,c,e,a,b,d){if(typeof(f)!=="object"){return}var g=this;g.timeHtmlObj=f;this.updateCountdown=function(){g.countdown.getCurrentTimestring();var i=g.countdown.getLeftoverTime();var h=g.countdown.getCurrentTimestring();if(i>0){percent=clampFloat(i/e,0,1);if(!a){pixel=Math.abs(d-d*percent)}else{pixel=Math.abs(d*percent)}pixel=clampInt(Math.round(pixel),0,d);if(b){g.timeHtmlObj.style.marginRight=pixel+"px"}else{g.timeHtmlObj.style.marginLeft=pixel+"px"}}};if(g.timeHtmlObj){g.countdown=new oldcountdown(c,3);timerHandler.appendCallback(g.updateCountdown);g.updateCountdown()}}function shipCountdown(c,f,i,d,a,h,g,e){if((typeof(c)!=="object")||(typeof(f)!=="object")||(typeof(i)!=="object")){return}var b=this;b.totalTimeHtmlObj=c;b.unitTimeHtmlObj=f;b.sumCountHtmlObj=i;this.updateCountdown=function(){b.unitCountdown.getCurrentTimestring();unitTimestamp=b.unitCountdown.getLeftoverTime();unitTimestring=b.unitCountdown.getCurrentTimestring();b.totalCountdown.getCurrentTimestring();totalTimestamp=b.totalCountdown.getLeftoverTime();totalTimestring=b.totalCountdown.getCurrentTimestring();if(unitTimestamp>0){b.unitTimeHtmlObj.innerHTML=unitTimestring}else{g--;b.unitTimeHtmlObj.innerHTML=LocalizationStrings.status.ready;if(g>0){b.unitCountdown=new oldcountdown(d);b.sumCountHtmlObj.innerHTML=g}else{b.sumCountHtmlObj.innerHTML=0}}if(g>0){b.totalTimeHtmlObj.innerHTML=totalTimestring}else{b.totalTimeHtmlObj.innerHTML=LocalizationStrings.status.ready;if(!isOverlayOpen()){reload_page(e)}}};if((b.totalTimeHtmlObj)&&(b.unitTimeHtmlObj)&&(b.sumCountHtmlObj)){b.totalCountdown=new oldcountdown(h);b.unitCountdown=new oldcountdown(a);timerHandler.appendCallback(b.updateCountdown);b.updateCountdown()}}function reload_page(a){if(timerHandler&&timerHandler.pageReloadAlreadyTriggered==false){timerHandler.pageReloadAlreadyTriggered=true;openParentLocation(a)}}var Countdown=Countdown||(function(){var b=null;function a(){var c=null,d=null;return{startCounter:function(){if(c==null){c=setInterval(function(){var e=Math.floor(Date.now()/1000);if(d==null){Countdown.getInstance().refreshCountdowns()}d.each(function(){var g=$(this),f={units:{weeks:LocalizationStrings.timeunits["short"]["week"],days:LocalizationStrings.timeunits["short"]["day"],hours:LocalizationStrings.timeunits["short"]["hour"],minutes:LocalizationStrings.timeunits["short"]["minute"],seconds:LocalizationStrings.timeunits["short"]["second"]}};if(g.data("segments")){f.segments=g.data("segments")}if(g.data("now")){f.now=g.data("now")}g.attr("datetime",Formatter.secondsToPeriod(g.data("end")-e)).html(Formatter.secondsToTime(g.data("end")-e,f));if(g.data("end")-e<=0){g.removeClass("countdown");Countdown.getInstance().refreshCountdowns();if(g.data("onfinish")&&typeof window[g.data("onfinish")]=="function"){window[g.data("onfinish")].call(g)}}})},1000)}return true},stopCounter:function(){clearInterval(c);c=null;return true},refreshCountdowns:function(){d=$("time.countdown");return true}}}return{getInstance:function(){if(b==null){b=a()}return b}}})();