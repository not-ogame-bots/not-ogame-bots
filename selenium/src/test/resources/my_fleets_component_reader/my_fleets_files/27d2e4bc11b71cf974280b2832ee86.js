function showGoogleAnalytics(){var c=(("https:"==document.location.protocol)?"https://ssl.":"http://www.");document.write(decodeURI("%3Cscript src='"+c+"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));try{var a=_gat._getTracker("UA-11968132-1");a._setDomainName(".ogame.gameforge.com");a._trackPageview()}catch(b){}}function changeSetting(c,d,e,b,a){$.ajax({type:"POST",url:changeSettingsLink,dataType:"json",data:{token:changeSettingsToken,key:c,value:d},success:function(f){changeSettingsToken=f.newToken;if(f.message.length>0){fadeBox(f.message,f.error)}if(!f.error&&typeof(e)=="function"){e()}else{if(f.error&&typeof(b)=="function"){b()}}},error:function(f){if(typeof(a)=="undefined"||a){fadeBox(LocalizationStrings.error,true)}if(f.error&&typeof(b)=="function"){b()}}})}function getOverlayText(a){if(a.hasClass("building")&&a.children().hasClass("build-faster-img")){return questionbuilding}else{if(a.hasClass("building")&&a.children().hasClass("build-finish-img")){return questionbuilding}else{if(a.hasClass("ship")&&a.children().hasClass("build-faster-img")){return questionship}else{if(a.hasClass("ship")&&a.children().hasClass("build-finish-img")){return questionship}else{if(a.hasClass("research")&&a.children().hasClass("build-faster-img")){return questionresearch}else{if(a.hasClass("research")&&a.children().hasClass("build-finish-img")){return questionresearch}}}}}}}function getFastBuildPrice(a){if(a.hasClass("building")){return pricebuilding}else{if(a.hasClass("research")){return priceresearch}else{if(a.hasClass("ship")){return priceship}}}}function getRedirectLink(c){var b={};if(c!=undefined){for(var a in c){b[a]=c[a]}return $.param.fragment($.param.querystring(window.location.href,b),{})}else{return window.location.href.split("#")[0]}}function sendShips(a,f,e,b,c,d){if(shipsendingDone==1){shipsendingDone=0;params={mission:a,galaxy:f,system:e,position:b,type:c,shipCount:d,token:miniFleetToken};$.ajax(miniFleetLink,{data:params,dataType:"json",type:"POST",success:function(g){if(typeof(g.newToken)!="undefined"){miniFleetToken=g.newToken}displayMiniFleetMessage(g.response)}})}}function sendShipsWithPopup(a,f,e,b,c,d){params={mission:a,galaxy:f,system:e,position:b,type:c,shipCount:d,token:miniFleetToken};$.ajax(miniFleetLink,{data:params,dataType:"json",type:"POST",success:function(g){if(typeof(g.newToken)!="undefined"){miniFleetToken=g.newToken}fadeBox(g.response.message+" "+g.response.coordinates.galaxy+":"+g.response.coordinates.system+":"+g.response.coordinates.position,!g.response.success)}})}function outlawWarning(d,a,b,e,g,i,h){if(typeof(h)!="function"){if(d==constants.espionage){h=c}else{if(d==constants.missleattack){h=f}}}if(showOutlawWarning){errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.outlawWarning,LocalizationStrings.yes,LocalizationStrings.no,h)}else{h()}function c(){sendShips(d,a,b,e,g,i)}function f(){openOverlay(missleAttackLink+"&galaxy="+a+"&system="+b+"&position="+e+"&planetType="+g,{modal:true})}}function initThousandSeparator(){$(".checkThousandSeparator").unbind("keyup.checkThousandSeparator").bind("keyup.checkThousandSeparator",function(b){if(b.which==8||b.which==46){var a=$(this).getSelection();var d=$(this).val();if(d.substr(a.start-1,1)==LocalizationStrings.thousandSeperator){var c;if(b.which==8){c=d.substr(0,a.start-2)+d.substr(a.start-1)}else{c=d.substr(0,a.start)+d.substr(a.start+1)}formatNumber($(this),c)}}})}function initIndex(){initConnectionErrorFunction();timerHandler.appendCallback(function(){localTime=new Date();serverTime=new Date(localTime.valueOf()+timeDiff);$(".OGameClock").html(getFormatedDate(serverTime.getTime(),"[d].[m].[Y] <span>[H]:[i]:[s]</span>"))});$("select").ogameDropDown();$("#planet .slot").hover(function(){$(this).addClass("slot-hover")},function(){$(this).removeClass("slot-hover")});$("#eventboxFilled").hover(function(){$(this).addClass("eventboxHover")},function(){$(this).removeClass("qeventboxHover")});$(document).undelegate("a.build-faster","click").delegate("a.build-faster","click",function(){var c=$(this);if(darkMatter<getFastBuildPrice(c)){errorBoxDecision(LocalizationStrings.error,LocalizationStrings.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectPremium);return}var b=$.deparam.querystring().page;errorBoxDecision(LocalizationStrings.notice,getOverlayText(c),LocalizationStrings.yes,LocalizationStrings.no,function(){$.ajax({url:c.attr("rel"),data:{ajax:1,token:c.attr("token"),referrerPage:b},type:"POST",dataType:"json",error:function(){fadeBox(LocalizationStrings.error,true);c.addClass("disabled")},success:function(d){activateToken=d.newToken;if(d.error){fadeBox(d.message,true);c.addClass("disabled")}else{location.href=getRedirectLink()}}});return false})}).undelegate(".slideIn","click").delegate(".slideIn","click",function(){$(".slideIn").removeClass("active");var b=$(this).attr("ref");$("a[ref='"+b+"']").addClass("active");Tipped.hideAll();$("html, body").animate({scrollTop:0},500);gfSlider.slideIn(getElementByIdWithCache("detail"),b)}).undelegate("a.close_details","click").delegate("a.close_details","click",function(){if(window.gfSlider!==undefined){gfSlider.hide(getElementByIdWithCache("detail"))}});$("#banner_skyscraper a.close_details").click(function(){changeSetting("hideBanner",$(this).attr("ref"),function(){$("#banner_skyscraper").remove()})});var a=$("#wreckFieldCountDown");if(a){new simpleCountdown(a,a.data("duration"),null)}initHideElements();initOverlays();initThousandSeparator();initTooltips();initPlanetSorting();initRetinaImages();initBDayEventHints()}function initPlanetSorting(){$("#planetList.sortable").sortable({start:function(){Tipped.hideAll()},stop:function(){Tipped.hideAll();changeSetting("customPlanetOrder",$(this).sortable("toArray"))}});if($(".lockPlanets").hasClass("closed")){$("#planetList.sortable").sortable("disable")}$(".lockPlanets").unbind("click").bind("click",function(){var a=$(this);changeSetting("planetOrderLocked",a.hasClass("open")?1:0,function(){var b;if(a.hasClass("open")){a.removeClass("open").addClass("closed");$("#planetList.sortable").sortable("disable");b=LocalizationStrings.planetOrder.unlock}else{a.removeClass("closed").addClass("open");$("#planetList.sortable").sortable("enable");b=LocalizationStrings.planetOrder.lock}changeTooltip(a,b)})})}function initHideElements(){$(document).undelegate("html","touchstart.hideElem click.hideElem").delegate("html","touchstart.hideElem click.hideElem",function(f){f.stopPropagation();if($(this).data("noclick")){return}if(isMobile){var a=f.target.tagName.toUpperCase();if(!(a==="TEXTAREA"||a==="INPUT"||a==="SELECT")){document.activeElement.blur()}if(!$(f.target).parents(".markItUpHeader ul").length){$(".markItUpHeader ul ul").hide()}}else{if($(f.target).parents(".ui-dialog").length||$(f.target).parents(".tpd-tooltip").length){return}var g=$(".overlayDiv");if(typeof(g.data("uiDialog"))!="undefined"){var c=g.find(".markItUpDropMenu[id]");for(var b=0;b<c.length;++b){var d=$("body>ul[rel="+c[b].id+"]");d.hide()}g.dialog("close")}}})}function initJumpgate(){$("select").ogameDropDown();$(".list tr:even").addClass("alt");$(document).undelegate("#jumpgateForm .ship_input_row .textinput","keyup change input").delegate("#jumpgateForm .ship_input_row .textinput","keyup change input",function(){checkIntInput(this,0,$(this).attr("rel"))}).undelegate("#jumpgateForm .ship_input_row .textinput","focus").delegate("#jumpgateForm .ship_input_row .textinput","focus",function(){$(this).val("")});$("#jumpgate .answerHeadline, .js_openStandardMoonMenu").click(function(){if(!player.hasCommander){errorBoxNotify(LocalizationStrings.error,translation.changeSettingOnlyWithCommander,LocalizationStrings.ok,null,false)}else{$("#jumpgate").find(".answerHeadline").toggleClass("open");$(".thirdCol").toggleClass("hidden")}});$(".js_executeJumpButton").click(function(){var a=$("#jumpgateForm").find('select[name="zm"]').val();window.jumpGateTargetId=a;if(a!=0){var b=true;$(".ship_selection_table input").each(function(){if($(this).val()>0){b=false}});if(!b){ajaxFormSubmit("jumpgateForm",$(this).attr("data-url"),jumpgateDone)}else{fadeBox(translation.noShipsWereSelected,true)}}else{fadeBox(translation.validTargetNeeded,true)}})}function jumpgateDone(a){var a=$.parseJSON(a);if(a.status){planet=a.targetMoon;$(".overlayDiv").dialog("destroy")}errorBoxAsArray(a.errorbox);if(typeof(a.newToken)!="undefined"){setNewTokenData(a.newToken)}}function jumpgateDefaultTargetSelectionCallback(c){var c=$.parseJSON(c);if(c.status){var a=$("#jumpgateForm").find('select[name="zm"]');a.find("option").removeAttr("selected");var b=a.find('option[value="'+c.targetMoon+'"]');if(b.length){b.attr("selected","selected")}else{if(a.find('option[value="0"]').length==0){a.append($(document.createElement("option")).attr("value",0).attr("selected","selected").text("--"))}else{a.find('option[value="0"]').attr("selected","selected")}}a.trigger("change");a.ogameDropDown("refresh")}errorBoxAsArray(c.errorbox);if(typeof(c.newToken)!="undefined"){setNewTokenData(c.newToken)}}function setNewTokenData(a){$('#jumpgateForm input[name="token"]').val(a);$('#jumpgateDefaultTargetSelectionForm input[name="token"]').val(a)}function openJumpgate(){openOverlay(jumpGateLink,{title:jumpGateLoca.LOCA_STATION_JUMPGATE_HEADLINE})}function redirectLogout(){location.href=redirectLogoutLink}function redirectOverview(){location.href=redirectOverviewLink}function redirectSpaceDock(){location.href=redirectSpaceDockLink};