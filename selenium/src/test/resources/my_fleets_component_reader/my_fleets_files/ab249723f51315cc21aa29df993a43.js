(function(b){b.colorpicker=new function(){this.regional=[];this.regional[""]={ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"};this.swatches=[];this.swatches.html={black:{r:0,g:0,b:0},dimgray:{r:0.4117647058823529,g:0.4117647058823529,b:0.4117647058823529},gray:{r:0.5019607843137255,g:0.5019607843137255,b:0.5019607843137255},darkgray:{r:0.6627450980392157,g:0.6627450980392157,b:0.6627450980392157},silver:{r:0.7529411764705882,g:0.7529411764705882,b:0.7529411764705882},lightgrey:{r:0.8274509803921568,g:0.8274509803921568,b:0.8274509803921568},gainsboro:{r:0.8627450980392157,g:0.8627450980392157,b:0.8627450980392157},whitesmoke:{r:0.9607843137254902,g:0.9607843137254902,b:0.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:0.7372549019607844,g:0.5607843137254902,b:0.5607843137254902},indianred:{r:0.803921568627451,g:0.3607843137254902,b:0.3607843137254902},brown:{r:0.6470588235294118,g:0.16470588235294117,b:0.16470588235294117},firebrick:{r:0.6980392156862745,g:0.13333333333333333,b:0.13333333333333333},lightcoral:{r:0.9411764705882353,g:0.5019607843137255,b:0.5019607843137255},maroon:{r:0.5019607843137255,g:0,b:0},darkred:{r:0.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:0.9803921568627451,b:0.9803921568627451},salmon:{r:0.9803921568627451,g:0.5019607843137255,b:0.4470588235294118},mistyrose:{r:1,g:0.8941176470588236,b:0.8823529411764706},tomato:{r:1,g:0.38823529411764707,b:0.2784313725490196},darksalmon:{r:0.9137254901960784,g:0.5882352941176471,b:0.47843137254901963},orangered:{r:1,g:0.27058823529411763,b:0},coral:{r:1,g:0.4980392156862745,b:0.3137254901960784},lightsalmon:{r:1,g:0.6274509803921569,b:0.47843137254901963},sienna:{r:0.6274509803921569,g:0.3215686274509804,b:0.17647058823529413},seashell:{r:1,g:0.9607843137254902,b:0.9333333333333333},chocolate:{r:0.8235294117647058,g:0.4117647058823529,b:0.11764705882352941},saddlebrown:{r:0.5450980392156862,g:0.27058823529411763,b:0.07450980392156863},sandybrown:{r:0.9568627450980393,g:0.6431372549019608,b:0.3764705882352941},peachpuff:{r:1,g:0.8549019607843137,b:0.7254901960784313},peru:{r:0.803921568627451,g:0.5215686274509804,b:0.24705882352941178},linen:{r:0.9803921568627451,g:0.9411764705882353,b:0.9019607843137255},darkorange:{r:1,g:0.5490196078431373,b:0},bisque:{r:1,g:0.8941176470588236,b:0.7686274509803922},burlywood:{r:0.8705882352941177,g:0.7215686274509804,b:0.5294117647058824},tan:{r:0.8235294117647058,g:0.7058823529411765,b:0.5490196078431373},antiquewhite:{r:0.9803921568627451,g:0.9215686274509803,b:0.8431372549019608},navajowhite:{r:1,g:0.8705882352941177,b:0.6784313725490196},blanchedalmond:{r:1,g:0.9215686274509803,b:0.803921568627451},papayawhip:{r:1,g:0.9372549019607843,b:0.8352941176470589},orange:{r:1,g:0.6470588235294118,b:0},moccasin:{r:1,g:0.8941176470588236,b:0.7098039215686275},wheat:{r:0.9607843137254902,g:0.8705882352941177,b:0.7019607843137254},oldlace:{r:0.9921568627450981,g:0.9607843137254902,b:0.9019607843137255},floralwhite:{r:1,g:0.9803921568627451,b:0.9411764705882353},goldenrod:{r:0.8549019607843137,g:0.6470588235294118,b:0.12549019607843137},darkgoldenrod:{r:0.7215686274509804,g:0.5254901960784314,b:0.043137254901960784},cornsilk:{r:1,g:0.9725490196078431,b:0.8627450980392157},gold:{r:1,g:0.8431372549019608,b:0},palegoldenrod:{r:0.9333333333333333,g:0.9098039215686274,b:0.6666666666666666},khaki:{r:0.9411764705882353,g:0.9019607843137255,b:0.5490196078431373},lemonchiffon:{r:1,g:0.9803921568627451,b:0.803921568627451},darkkhaki:{r:0.7411764705882353,g:0.7176470588235294,b:0.4196078431372549},beige:{r:0.9607843137254902,g:0.9607843137254902,b:0.8627450980392157},lightgoldenrodyellow:{r:0.9803921568627451,g:0.9803921568627451,b:0.8235294117647058},olive:{r:0.5019607843137255,g:0.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:0.8784313725490196},ivory:{r:1,g:1,b:0.9411764705882353},olivedrab:{r:0.4196078431372549,g:0.5568627450980392,b:0.13725490196078433},yellowgreen:{r:0.6039215686274509,g:0.803921568627451,b:0.19607843137254902},darkolivegreen:{r:0.3333333333333333,g:0.4196078431372549,b:0.1843137254901961},greenyellow:{r:0.6784313725490196,g:1,b:0.1843137254901961},lawngreen:{r:0.48627450980392156,g:0.9882352941176471,b:0},chartreuse:{r:0.4980392156862745,g:1,b:0},darkseagreen:{r:0.5607843137254902,g:0.7372549019607844,b:0.5607843137254902},forestgreen:{r:0.13333333333333333,g:0.5450980392156862,b:0.13333333333333333},limegreen:{r:0.19607843137254902,g:0.803921568627451,b:0.19607843137254902},lightgreen:{r:0.5647058823529412,g:0.9333333333333333,b:0.5647058823529412},palegreen:{r:0.596078431372549,g:0.984313725490196,b:0.596078431372549},darkgreen:{r:0,g:0.39215686274509803,b:0},green:{r:0,g:0.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:0.9411764705882353,g:1,b:0.9411764705882353},mediumseagreen:{r:0.23529411764705882,g:0.7019607843137254,b:0.44313725490196076},seagreen:{r:0.1803921568627451,g:0.5450980392156862,b:0.3411764705882353},springgreen:{r:0,g:1,b:0.4980392156862745},mintcream:{r:0.9607843137254902,g:1,b:0.9803921568627451},mediumspringgreen:{r:0,g:0.9803921568627451,b:0.6039215686274509},mediumaquamarine:{r:0.4,g:0.803921568627451,b:0.6666666666666666},aquamarine:{r:0.4980392156862745,g:1,b:0.8313725490196079},turquoise:{r:0.25098039215686274,g:0.8784313725490196,b:0.8156862745098039},lightseagreen:{r:0.12549019607843137,g:0.6980392156862745,b:0.6666666666666666},mediumturquoise:{r:0.2823529411764706,g:0.8196078431372549,b:0.8},darkslategray:{r:0.1843137254901961,g:0.30980392156862746,b:0.30980392156862746},paleturquoise:{r:0.6862745098039216,g:0.9333333333333333,b:0.9333333333333333},teal:{r:0,g:0.5019607843137255,b:0.5019607843137255},darkcyan:{r:0,g:0.5450980392156862,b:0.5450980392156862},darkturquoise:{r:0,g:0.807843137254902,b:0.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:0.8784313725490196,g:1,b:1},azure:{r:0.9411764705882353,g:1,b:1},cadetblue:{r:0.37254901960784315,g:0.6196078431372549,b:0.6274509803921569},powderblue:{r:0.6901960784313725,g:0.8784313725490196,b:0.9019607843137255},lightblue:{r:0.6784313725490196,g:0.8470588235294118,b:0.9019607843137255},deepskyblue:{r:0,g:0.7490196078431373,b:1},skyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9215686274509803},lightskyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9803921568627451},steelblue:{r:0.27450980392156865,g:0.5098039215686274,b:0.7058823529411765},aliceblue:{r:0.9411764705882353,g:0.9725490196078431,b:1},dodgerblue:{r:0.11764705882352941,g:0.5647058823529412,b:1},slategray:{r:0.4392156862745098,g:0.5019607843137255,b:0.5647058823529412},lightslategray:{r:0.4666666666666667,g:0.5333333333333333,b:0.6},lightsteelblue:{r:0.6901960784313725,g:0.7686274509803922,b:0.8705882352941177},cornflowerblue:{r:0.39215686274509803,g:0.5843137254901961,b:0.9294117647058824},royalblue:{r:0.2549019607843137,g:0.4117647058823529,b:0.8823529411764706},midnightblue:{r:0.09803921568627451,g:0.09803921568627451,b:0.4392156862745098},lavender:{r:0.9019607843137255,g:0.9019607843137255,b:0.9803921568627451},navy:{r:0,g:0,b:0.5019607843137255},darkblue:{r:0,g:0,b:0.5450980392156862},mediumblue:{r:0,g:0,b:0.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:0.9725490196078431,g:0.9725490196078431,b:1},darkslateblue:{r:0.2823529411764706,g:0.23921568627450981,b:0.5450980392156862},slateblue:{r:0.41568627450980394,g:0.35294117647058826,b:0.803921568627451},mediumslateblue:{r:0.4823529411764706,g:0.40784313725490196,b:0.9333333333333333},mediumpurple:{r:0.5764705882352941,g:0.4392156862745098,b:0.8588235294117647},blueviolet:{r:0.5411764705882353,g:0.16862745098039217,b:0.8862745098039215},indigo:{r:0.29411764705882354,g:0,b:0.5098039215686274},darkorchid:{r:0.6,g:0.19607843137254902,b:0.8},darkviolet:{r:0.5803921568627451,g:0,b:0.8274509803921568},mediumorchid:{r:0.7294117647058823,g:0.3333333333333333,b:0.8274509803921568},thistle:{r:0.8470588235294118,g:0.7490196078431373,b:0.8470588235294118},plum:{r:0.8666666666666667,g:0.6274509803921569,b:0.8666666666666667},violet:{r:0.9333333333333333,g:0.5098039215686274,b:0.9333333333333333},purple:{r:0.5019607843137255,g:0,b:0.5019607843137255},darkmagenta:{r:0.5450980392156862,g:0,b:0.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:0.8549019607843137,g:0.4392156862745098,b:0.8392156862745098},mediumvioletred:{r:0.7803921568627451,g:0.08235294117647059,b:0.5215686274509804},deeppink:{r:1,g:0.0784313725490196,b:0.5764705882352941},hotpink:{r:1,g:0.4117647058823529,b:0.7058823529411765},palevioletred:{r:0.8588235294117647,g:0.4392156862745098,b:0.5764705882352941},lavenderblush:{r:1,g:0.9411764705882353,b:0.9607843137254902},crimson:{r:0.8627450980392157,g:0.0784313725490196,b:0.23529411764705882},pink:{r:1,g:0.7529411764705882,b:0.796078431372549},lightpink:{r:1,g:0.7137254901960784,b:0.7568627450980392}}};var j=0,c='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',d='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',g={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},h=function(l){var k=Math.round(l).toString(16);if(k.length===1){k=("0"+k)}return k.toLowerCase()},e=function(l){var n,k;k=/^#?([a-fA-F0-9]{1,6})$/.exec(l);if(k){n=parseInt(k[1],16);return new a(((n>>16)&255)/255,((n>>8)&255)/255,(n&255)/255)}return new a()},i=function(p,A){var t,u,s,k,B,m,C,q,z,o,v,n,l,r;p.sort(function(x,w){if(x.pos[1]==w.pos[1]){return x.pos[0]-w.pos[0]}return x.pos[1]-w.pos[1]});k=0;B=0;b.each(p,function(x,w){k=Math.max(k,w.pos[0]+w.pos[2]);B=Math.max(B,w.pos[1]+w.pos[3])});t=[];for(u=0;u<k;++u){t.push([])}C=[];m=[];b.each(p,function(x,w){for(u=0;u<w.pos[2];u+=1){m[w.pos[0]+u]=true}for(s=0;s<w.pos[3];s+=1){C[w.pos[1]+s]=true}});o="";z=p[q=0];for(s=0;s<B;++s){o+="<tr>";for(u=0;u<k;u){if(typeof z!=="undefined"&&u==z.pos[0]&&s==z.pos[1]){o+=A(z,u,s);for(n=0;n<z.pos[3];n+=1){for(v=0;v<z.pos[2];v+=1){t[u+v][s+n]=true}}u+=z.pos[2];z=p[++q]}else{l=0;r=false;while(u<k&&t[u][s]===undefined&&(z===undefined||s<z.pos[1]||(s==z.pos[1]&&u<z.pos[0]))){if(m[u]===true){l+=1}r=true;u+=1}if(l>0){o+='<td colspan="'+l+'"></td>'}else{if(!r){u+=1}}}}o+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+o+"</tbody></table>"},f={header:function(m){var l=this,n=null,k=function(){var p=m.options.title||m._getRegional("title"),o='<span class="ui-dialog-title">'+p+"</span>";if(!m.inline&&m.options.showCloseButton){o+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'}return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+o+"</div>"};this.init=function(){n=b(k()).prependTo(m.dialog);var o=b(".ui-dialog-titlebar-close",n);m._hoverable(o);m._focusable(o);o.click(function(p){p.preventDefault();m.close()});if(!m.inline&&m.options.draggable){m.dialog.draggable({handle:n})}}},map:function(q){var o=this,r=null,p=null,l,n,m,k;l=function(v){if(!q.opened){return}var A=b(".ui-colorpicker-map-layer-pointer",r),w=A.offset(),u=A.width(),t=A.height(),s=v.pageX-w.left,z=v.pageY-w.top;if(s>=0&&s<u&&z>=0&&z<t){v.stopImmediatePropagation();v.preventDefault();r.unbind("mousedown",l);b(document).bind("mouseup",n);b(document).bind("mousemove",m);m(v)}};n=function(s){s.stopImmediatePropagation();s.preventDefault();b(document).unbind("mouseup",n);b(document).unbind("mousemove",m);r.bind("mousedown",l)};m=function(v){v.stopImmediatePropagation();v.preventDefault();if(v.pageX===o.x&&v.pageY===o.y){return}o.x=v.pageX;o.y=v.pageY;var A=b(".ui-colorpicker-map-layer-pointer",r),w=A.offset(),u=A.width(),t=A.height(),s=v.pageX-w.left,z=v.pageY-w.top;s=Math.max(0,Math.min(s/u,1));z=Math.max(0,Math.min(z/t,1));switch(q.mode){case"h":q.color.setHSV(null,s,1-z);break;case"s":case"a":q.color.setHSV(s,null,1-z);break;case"v":q.color.setHSV(s,1-z,null);break;case"r":q.color.setRGB(null,1-z,s);break;case"g":q.color.setRGB(1-z,null,s);break;case"b":q.color.setRGB(s,1-z,null);break}q._change()};k=function(){var s='<div class="ui-colorpicker-map ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(q.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return s};this.update=function(){switch(q.mode){case"h":b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 0",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).hide();break;case"s":case"a":b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show();break;case"v":b(r).css("background-color","black");b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -780px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).hide();break;case"r":b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1040px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show();break;case"g":b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1820px",opacity:""}).show();break;case"b":b(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -2080px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show();break}o.repaint()};this.repaint=function(){var u=b(".ui-colorpicker-map-layer-pointer",r),s=0,t=0;switch(q.mode){case"h":s=q.color.getHSV().s*u.width();t=(1-q.color.getHSV().v)*u.width();b(r).css("background-color",q.color.copy().normalize().toCSS());break;case"s":case"a":s=q.color.getHSV().h*u.width();t=(1-q.color.getHSV().v)*u.width();b(".ui-colorpicker-map-layer-2",r).css("opacity",1-q.color.getHSV().s);break;case"v":s=q.color.getHSV().h*u.width();t=(1-q.color.getHSV().s)*u.width();b(".ui-colorpicker-map-layer-1",r).css("opacity",q.color.getHSV().v);break;case"r":s=q.color.getRGB().b*u.width();t=(1-q.color.getRGB().g)*u.width();b(".ui-colorpicker-map-layer-2",r).css("opacity",q.color.getRGB().r);break;case"g":s=q.color.getRGB().b*u.width();t=(1-q.color.getRGB().r)*u.width();b(".ui-colorpicker-map-layer-2",r).css("opacity",q.color.getRGB().g);break;case"b":s=q.color.getRGB().r*u.width();t=(1-q.color.getRGB().g)*u.width();b(".ui-colorpicker-map-layer-2",r).css("opacity",q.color.getRGB().b);break}if(q.options.alpha){b(".ui-colorpicker-map-layer-alpha",r).css("opacity",1-q.color.getAlpha())}b(".ui-colorpicker-map-pointer",r).css({left:s-7,top:t-7})};this.init=function(){r=b(k()).appendTo(b(".ui-colorpicker-map-container",q.dialog));r.bind("mousedown",l)}},bar:function(p){var o=this,q=null,l,n,m,k;l=function(u){if(!p.opened){return}var z=b(".ui-colorpicker-bar-layer-pointer",q),v=z.offset(),t=z.width(),s=z.height(),r=u.pageX-v.left,w=u.pageY-v.top;if(r>=0&&r<t&&w>=0&&w<s){u.stopImmediatePropagation();u.preventDefault();q.unbind("mousedown",l);b(document).bind("mouseup",n);b(document).bind("mousemove",m);m(u)}};n=function(r){r.stopImmediatePropagation();r.preventDefault();b(document).unbind("mouseup",n);b(document).unbind("mousemove",m);q.bind("mousedown",l)};m=function(s){s.stopImmediatePropagation();s.preventDefault();if(s.pageY===o.y){return}o.y=s.pageY;var v=b(".ui-colorpicker-bar-layer-pointer",q),t=v.offset(),r=v.height(),u=s.pageY-t.top;u=Math.max(0,Math.min(u/r,1));switch(p.mode){case"h":p.color.setHSV(1-u,null,null);break;case"s":p.color.setHSV(null,1-u,null);break;case"v":p.color.setHSV(null,null,1-u);break;case"r":p.color.setRGB(1-u,null,null);break;case"g":p.color.setRGB(null,1-u,null);break;case"b":p.color.setRGB(null,null,1-u);break;case"a":p.color.setAlpha(1-u);break}p._change()};k=function(){var r='<div class="ui-colorpicker-bar ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(p.options.alpha){r+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'}r+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return r};this.update=function(){switch(p.mode){case"h":case"s":case"v":case"r":case"g":case"b":b(".ui-colorpicker-bar-layer-alpha",q).show();b(".ui-colorpicker-bar-layer-alphabar",q).hide();break;case"a":b(".ui-colorpicker-bar-layer-alpha",q).hide();b(".ui-colorpicker-bar-layer-alphabar",q).show();break}switch(p.mode){case"h":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 0",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).hide();b(".ui-colorpicker-bar-layer-3",q).hide();b(".ui-colorpicker-bar-layer-4",q).hide();break;case"s":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 -260px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).css({"background-position":"0 -520px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",q).hide();b(".ui-colorpicker-bar-layer-4",q).hide();break;case"v":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 -520px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).hide();b(".ui-colorpicker-bar-layer-3",q).hide();b(".ui-colorpicker-bar-layer-4",q).hide();break;case"r":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 -1560px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).css({"background-position":"0 -1300px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",q).css({"background-position":"0 -780px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",q).css({"background-position":"0 -1040px",opacity:""}).show();break;case"g":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 -2600px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).css({"background-position":"0 -2340px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",q).css({"background-position":"0 -1820px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",q).css({"background-position":"0 -2080px",opacity:""}).show();break;case"b":b(".ui-colorpicker-bar-layer-1",q).css({"background-position":"0 -3640px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",q).css({"background-position":"0 -3380px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",q).css({"background-position":"0 -2860px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",q).css({"background-position":"0 -3120px",opacity:""}).show();break;case"a":b(".ui-colorpicker-bar-layer-1",q).hide();b(".ui-colorpicker-bar-layer-2",q).hide();b(".ui-colorpicker-bar-layer-3",q).hide();b(".ui-colorpicker-bar-layer-4",q).hide();break}o.repaint()};this.repaint=function(){var s=b(".ui-colorpicker-bar-layer-pointer",q),r=0;switch(p.mode){case"h":r=(1-p.color.getHSV().h)*s.height();break;case"s":r=(1-p.color.getHSV().s)*s.height();b(".ui-colorpicker-bar-layer-2",q).css("opacity",1-p.color.getHSV().v);b(q).css("background-color",p.color.copy().normalize().toCSS());break;case"v":r=(1-p.color.getHSV().v)*s.height();b(q).css("background-color",p.color.copy().normalize().toCSS());break;case"r":r=(1-p.color.getRGB().r)*s.height();b(".ui-colorpicker-bar-layer-2",q).css("opacity",Math.max(0,(p.color.getRGB().b-p.color.getRGB().g)));b(".ui-colorpicker-bar-layer-3",q).css("opacity",Math.max(0,(p.color.getRGB().g-p.color.getRGB().b)));b(".ui-colorpicker-bar-layer-4",q).css("opacity",Math.min(p.color.getRGB().b,p.color.getRGB().g));break;case"g":r=(1-p.color.getRGB().g)*s.height();b(".ui-colorpicker-bar-layer-2",q).css("opacity",Math.max(0,(p.color.getRGB().b-p.color.getRGB().r)));b(".ui-colorpicker-bar-layer-3",q).css("opacity",Math.max(0,(p.color.getRGB().r-p.color.getRGB().b)));b(".ui-colorpicker-bar-layer-4",q).css("opacity",Math.min(p.color.getRGB().r,p.color.getRGB().b));break;case"b":r=(1-p.color.getRGB().b)*s.height();b(".ui-colorpicker-bar-layer-2",q).css("opacity",Math.max(0,(p.color.getRGB().r-p.color.getRGB().g)));b(".ui-colorpicker-bar-layer-3",q).css("opacity",Math.max(0,(p.color.getRGB().g-p.color.getRGB().r)));b(".ui-colorpicker-bar-layer-4",q).css("opacity",Math.min(p.color.getRGB().r,p.color.getRGB().g));break;case"a":r=(1-p.color.getAlpha())*s.height();b(q).css("background-color",p.color.copy().normalize().toCSS());break}if(p.mode!=="a"){b(".ui-colorpicker-bar-layer-alpha",q).css("opacity",1-p.color.getAlpha())}b(".ui-colorpicker-bar-pointer",q).css("top",r-3)};this.init=function(){q=b(k()).appendTo(b(".ui-colorpicker-bar-container",p.dialog));q.bind("mousedown",l)}},preview:function(m){var l=this,n=null,k;k=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>'};this.init=function(){n=b(k()).appendTo(b(".ui-colorpicker-preview-container",m.dialog));b(".ui-colorpicker-preview-initial",n).click(function(){m.color=m.currentColor.copy();m._change()})};this.update=function(){if(m.options.alpha){b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",n).show()}else{b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",n).hide()}this.repaint()};this.repaint=function(){b(".ui-colorpicker-preview-initial",n).css("background-color",m.currentColor.toCSS()).attr("title",m.currentColor.toHex());b(".ui-colorpicker-preview-initial-alpha",n).css("opacity",1-m.currentColor.getAlpha());b(".ui-colorpicker-preview-current",n).css("background-color",m.color.toCSS()).attr("title",m.color.toHex());b(".ui-colorpicker-preview-current-alpha",n).css("opacity",1-m.color.getAlpha())}},hsv:function(m){var l=this,n=null,k;k=function(){var o="";if(m.options.hsv){o+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+m._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+m._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+m._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-hsv">'+o+"</div>"};this.init=function(){n=b(k()).appendTo(b(".ui-colorpicker-hsv-container",m.dialog));b(".ui-colorpicker-mode",n).click(function(){m.mode=b(this).val();m._updateAllParts()});b(".ui-colorpicker-number",n).bind("change keyup",function(){m.color.setHSV(b(".ui-colorpicker-hsv-h .ui-colorpicker-number",n).val()/360,b(".ui-colorpicker-hsv-s .ui-colorpicker-number",n).val()/100,b(".ui-colorpicker-hsv-v .ui-colorpicker-number",n).val()/100);m._change()})};this.repaint=function(){var o=m.color.getHSV();o.h*=360;o.s*=100;o.v*=100;b.each(o,function(q,r){var p=b(".ui-colorpicker-hsv-"+q+" .ui-colorpicker-number",n);r=Math.round(r);if(p.val()!==r){p.val(r)}})};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){b(this).attr("checked",b(this).val()===m.mode)});this.repaint()}},rgb:function(m){var l=this,n=null,k;k=function(){var o="";if(m.options.rgb){o+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+m._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+m._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+m._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'}return'<div class="ui-colorpicker-rgb">'+o+"</div>"};this.init=function(){n=b(k()).appendTo(b(".ui-colorpicker-rgb-container",m.dialog));b(".ui-colorpicker-mode",n).click(function(){m.mode=b(this).val();m._updateAllParts()});b(".ui-colorpicker-number",n).bind("change keyup",function(){m.color.setRGB(b(".ui-colorpicker-rgb-r .ui-colorpicker-number",n).val()/255,b(".ui-colorpicker-rgb-g .ui-colorpicker-number",n).val()/255,b(".ui-colorpicker-rgb-b .ui-colorpicker-number",n).val()/255);m._change()})};this.repaint=function(){b.each(m.color.getRGB(),function(p,q){var o=b(".ui-colorpicker-rgb-"+p+" .ui-colorpicker-number",n);q=Math.round(q*255);if(o.val()!==q){o.val(q)}})};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){b(this).attr("checked",b(this).val()===m.mode)});this.repaint()}},lab:function(n){var m=this,k=null,l=function(){var o="";if(n.options.hsv){o+='<div class="ui-colorpicker-lab-l"><label>'+n._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+n._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+n._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'}return'<div class="ui-colorpicker-lab">'+o+"</div>"};this.init=function(){var o=0;k=b(l()).appendTo(b(".ui-colorpicker-lab-container",n.dialog));b(".ui-colorpicker-number",k).on("change keyup",function(p){n.color.setLAB(parseInt(b(".ui-colorpicker-lab-l .ui-colorpicker-number",k).val(),10)/100,(parseInt(b(".ui-colorpicker-lab-a .ui-colorpicker-number",k).val(),10)+128)/255,(parseInt(b(".ui-colorpicker-lab-b .ui-colorpicker-number",k).val(),10)+128)/255);n._change()})};this.repaint=function(){var o=n.color.getLAB();o.l*=100;o.a=(o.a*255)-128;o.b=(o.b*255)-128;b.each(o,function(q,r){var p=b(".ui-colorpicker-lab-"+q+" .ui-colorpicker-number",k);r=Math.round(r);if(p.val()!==r){p.val(r)}})};this.update=function(){this.repaint()}},cmyk:function(n){var m=this,k=null,l=function(){var o="";if(n.options.hsv){o+='<div class="ui-colorpicker-cmyk-c"><label>'+n._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+n._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+n._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+n._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-cmyk">'+o+"</div>"};this.init=function(){k=b(l()).appendTo(b(".ui-colorpicker-cmyk-container",n.dialog));b(".ui-colorpicker-number",k).on("change keyup",function(o){n.color.setCMYK(parseInt(b(".ui-colorpicker-cmyk-c .ui-colorpicker-number",k).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-m .ui-colorpicker-number",k).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-y .ui-colorpicker-number",k).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-k .ui-colorpicker-number",k).val(),10)/100);n._change()})};this.repaint=function(){b.each(n.color.getCMYK(),function(p,q){var o=b(".ui-colorpicker-cmyk-"+p+" .ui-colorpicker-number",k);q=Math.round(q*100);if(o.val()!==q){o.val(q)}})};this.update=function(){this.repaint()}},alpha:function(m){var l=this,n=null,k;k=function(){var o="";if(m.options.alpha){o+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+m._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-alpha">'+o+"</div>"};this.init=function(){n=b(k()).appendTo(b(".ui-colorpicker-alpha-container",m.dialog));b(".ui-colorpicker-mode",n).click(function(){m.mode=b(this).val();m._updateAllParts()});b(".ui-colorpicker-number",n).bind("change keyup",function(){m.color.setAlpha(b(".ui-colorpicker-a .ui-colorpicker-number",n).val()/100);m._change()})};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){b(this).attr("checked",b(this).val()===m.mode)});this.repaint()};this.repaint=function(){var o=b(".ui-colorpicker-a .ui-colorpicker-number",n),p=Math.round(m.color.getAlpha()*100);if(!o.is(":focus")&&o.val()!==p){o.val(p)}}},hex:function(m){var l=this,n=null,k;k=function(){var o="";if(m.options.alpha){o+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'}o+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+o+"</div>"};this.init=function(){n=b(k()).appendTo(b(".ui-colorpicker-hex-container",m.dialog));b(".ui-colorpicker-hex-input",n).bind("change keydown keyup",function(p,o,q){if(/[^a-fA-F0-9]/.test(b(this).val())){b(this).val(b(this).val().replace(/[^a-fA-F0-9]/,""))}});b(".ui-colorpicker-hex-input",n).bind("change keyup",function(){m.color=e(b(this).val()).setAlpha(m.color.getAlpha());m._change()});b(".ui-colorpicker-hex-alpha",n).bind("change keydown keyup",function(){if(/[^a-fA-F0-9]/.test(b(this).val())){b(this).val(b(this).val().replace(/[^a-fA-F0-9]/,""))}});b(".ui-colorpicker-hex-alpha",n).bind("change keyup",function(){m.color.setAlpha(parseInt(b(".ui-colorpicker-hex-alpha",n).val(),16)/255);m._change()})};this.update=function(){this.repaint()};this.repaint=function(){if(!b(".ui-colorpicker-hex-input",n).is(":focus")){b(".ui-colorpicker-hex-input",n).val(m.color.toHex(true))}if(!b(".ui-colorpicker-hex-alpha",n).is(":focus")){b(".ui-colorpicker-hex-alpha",n).val(h(m.color.getAlpha()*255))}}},swatches:function(n){var m=this,k=null,l=function(){var o="";b.each(n._getSwatches(),function(q,p){var s=new a(p.r,p.g,p.b),r=s.toCSS();o+='<div class="ui-colorpicker-swatch" style="background-color:'+r+'" title="'+q+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+n.options.swatchesWidth+'px">'+o+"</div>"};this.init=function(){k=b(l()).appendTo(b(".ui-colorpicker-swatches-container",n.dialog));b(".ui-colorpicker-swatch",k).click(function(){n.color=n._parseColor(b(this).css("background-color"));n._change()})}},footer:function(p){var o=this,m=null,k="ui-colorpicker-special-transparent-"+j,l="ui-colorpicker-special-none-"+j,n=function(){var q="";if(p.options.alpha||(!p.inline&&p.options.showNoneButton)){q+='<div class="ui-colorpicker-buttonset">';if(p.options.alpha){q+='<input type="radio" name="ui-colorpicker-special" id="'+k+'" class="ui-colorpicker-special-transparent"/><label for="'+k+'">'+p._getRegional("transparent")+"</label>"}if(!p.inline&&p.options.showNoneButton){q+='<input type="radio" name="ui-colorpicker-special" id="'+l+'" class="ui-colorpicker-special-none"><label for="'+l+'">'+p._getRegional("none")+"</label>"}q+="</div>"}if(!p.inline){q+='<div class="ui-dialog-buttonset">';if(p.options.showCancelButton){q+='<button class="ui-colorpicker-cancel">'+p._getRegional("cancel")+"</button>"}q+='<button class="ui-colorpicker-ok">'+p._getRegional("ok")+"</button>";q+="</div>"}return'<div class="ui-dialog-buttonpane ui-widget-content">'+q+"</div>"};this.init=function(){m=b(n()).appendTo(p.dialog);b(".ui-colorpicker-ok",m).button().click(function(){p.close()});b(".ui-colorpicker-cancel",m).button().click(function(){p.color=p.currentColor.copy();p._change(p.color.set);p.close()});b(".ui-colorpicker-buttonset",m).buttonset();b(".ui-colorpicker-special-color",m).click(function(){p._change()});b("#"+l,m).click(function(){p._change(false)});b("#"+k,m).click(function(){p.color.setAlpha(0);p._change()})};this.repaint=function(){if(!p.color.set){b(".ui-colorpicker-special-none",m).attr("checked",true).button("refresh")}else{if(p.color.getAlpha()==0){b(".ui-colorpicker-special-transparent",m).attr("checked",true).button("refresh")}else{b("input",m).attr("checked",false).button("refresh")}}b(".ui-colorpicker-cancel",m).button(p.changed?"enable":"disable")};this.update=function(){}}},a=function(){var v={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},y=1,w=arguments,A=function(B){if(isNaN(B)||B===null){return 0}if(typeof B=="string"){B=parseInt(B,10)}return Math.max(0,Math.min(B,1))},r=function(E){var F="0123456789abcdef",D=E%16,C=(E-D)/16,B=F.charAt(C)+F.charAt(D);return B},p=function(C){var E=(C.r>0.04045)?Math.pow((C.r+0.055)/1.055,2.4):C.r/12.92,D=(C.g>0.04045)?Math.pow((C.g+0.055)/1.055,2.4):C.g/12.92,B=(C.b>0.04045)?Math.pow((C.b+0.055)/1.055,2.4):C.b/12.92;return{x:E*0.4124+D*0.3576+B*0.1805,y:E*0.2126+D*0.7152+B*0.0722,z:E*0.0193+D*0.1192+B*0.9505}},o=function(B){var C={r:B.x*3.2406+B.y*-1.5372+B.z*-0.4986,g:B.x*-0.9689+B.y*1.8758+B.z*0.0415,b:B.x*0.0557+B.y*-0.204+B.z*1.057};C.r=(C.r>0.0031308)?1.055*Math.pow(C.r,(1/2.4))-0.055:12.92*C.r;C.g=(C.g>0.0031308)?1.055*Math.pow(C.g,(1/2.4))-0.055:12.92*C.g;C.b=(C.b>0.0031308)?1.055*Math.pow(C.b,(1/2.4))-0.055:12.92*C.b;return C},l=function(D){var B=Math.min(D.r,D.g,D.b),I=Math.max(D.r,D.g,D.b),H=I-B,F,E,G,C={h:0,s:0,v:I};if(H===0){C.h=0;C.s=0}else{C.s=H/I;F=(((I-D.r)/6)+(H/2))/H;E=(((I-D.g)/6)+(H/2))/H;G=(((I-D.b)/6)+(H/2))/H;if(D.r===I){C.h=G-E}else{if(D.g===I){C.h=(1/3)+F-G}else{if(D.b===I){C.h=(2/3)+E-F}}}if(C.h<0){C.h+=1}else{if(C.h>1){C.h-=1}}}return C},x=function(H){var G={r:0,g:0,b:0},F,D,E,C,B;if(H.s===0){G.r=G.g=G.b=H.v}else{F=H.h===1?0:H.h*6;D=Math.floor(F);E=H.v*(1-H.s);C=H.v*(1-H.s*(F-D));B=H.v*(1-H.s*(1-(F-D)));if(D===0){G.r=H.v;G.g=B;G.b=E}else{if(D===1){G.r=C;G.g=H.v;G.b=E}else{if(D===2){G.r=E;G.g=H.v;G.b=B}else{if(D===3){G.r=E;G.g=C;G.b=H.v}else{if(D===4){G.r=B;G.g=E;G.b=H.v}else{G.r=H.v;G.g=E;G.b=C}}}}}}return G},s=function(D){var B=Math.min(D.r,D.g,D.b),I=Math.max(D.r,D.g,D.b),H=I-B,F,E,G,C={h:0,s:0,l:(I+B)/2};if(H===0){C.h=0;C.s=0}else{C.s=C.l<0.5?H/(I+B):H/(2-I-B);F=(((I-D.r)/6)+(H/2))/H;E=(((I-D.g)/6)+(H/2))/H;G=(((I-D.b)/6)+(H/2))/H;if(D.r===I){C.h=G-E}else{if(D.g===I){C.h=(1/3)+F-G}else{if(D.b===I){C.h=(2/3)+E-F}}}if(C.h<0){C.h+=1}else{if(C.h>1){C.h-=1}}}return C},u=function(D){var C,B,E=function(H,G,F){if(F<0){F+=1}if(F>1){F-=1}if((6*F)<1){return H+(G-H)*6*F}if((2*F)<1){return G}if((3*F)<2){return H+(G-H)*((2/3)-F)*6}return H};if(D.s===0){return{r:D.l,g:D.l,b:D.l}}B=(D.l<0.5)?D.l*(1+D.s):(D.l+D.s)-(D.s*D.l);C=2*D.l-B;return{r:E(C,B,D.h+(1/3)),g:E(C,B,D.h),b:E(C,B,D.h-(1/3))}},k=function(C){var B=C.x/0.95047,E=C.y,D=C.z/1.08883;B=(B>0.008856)?Math.pow(B,(1/3)):(7.787*B)+(16/116);E=(E>0.008856)?Math.pow(E,(1/3)):(7.787*E)+(16/116);D=(D>0.008856)?Math.pow(D,(1/3)):(7.787*D)+(16/116);return{l:((116*E)-16)/100,a:((500*(B-E))+128)/255,b:((200*(E-D))+128)/255}},q=function(C){var D={l:C.l*100,a:(C.a*255)-128,b:(C.b*255)-128},B={x:0,y:(D.l+16)/116,z:0};B.x=D.a/500+B.y;B.z=B.y-D.b/200;B.x=(Math.pow(B.x,3)>0.008856)?Math.pow(B.x,3):(B.x-16/116)/7.787;B.y=(Math.pow(B.y,3)>0.008856)?Math.pow(B.y,3):(B.y-16/116)/7.787;B.z=(Math.pow(B.z,3)>0.008856)?Math.pow(B.z,3):(B.z-16/116)/7.787;B.x*=0.95047;B.y*=1;B.z*=1.08883;return B},z=function(B){return{c:1-(B.r),m:1-(B.g),y:1-(B.b)}},t=function(B){return{r:1-(B.c),g:1-(B.m),b:1-(B.y)}},n=function(C){var B=1;if(C.c<B){B=C.c}if(C.m<B){B=C.m}if(C.y<B){B=C.y}if(B==1){return{c:0,m:0,y:0,k:1}}return{c:(C.c-B)/(1-B),m:(C.m-B)/(1-B),y:(C.y-B)/(1-B),k:B}},m=function(B){return{c:B.c*(1-B.k)+B.k,m:B.m*(1-B.k)+B.k,y:B.y*(1-B.k)+B.k}};this.set=true;this.setAlpha=function(B){if(B!==null){y=A(B)}return this};this.getAlpha=function(){return y};this.setRGB=function(D,C,B){v={rgb:this.getRGB()};if(D!==null){v.rgb.r=A(D)}if(C!==null){v.rgb.g=A(C)}if(B!==null){v.rgb.b=A(B)}return this};this.setHSV=function(D,C,B){v={hsv:this.getHSV()};if(D!==null){v.hsv.h=A(D)}if(C!==null){v.hsv.s=A(C)}if(B!==null){v.hsv.v=A(B)}return this};this.setHSL=function(D,C,B){v={hsl:this.getHSL()};if(D!==null){v.hsl.h=A(D)}if(C!==null){v.hsl.s=A(C)}if(B!==null){v.hsl.l=A(B)}return this};this.setLAB=function(D,C,B){v={lab:this.getLAB()};if(D!==null){v.lab.l=A(D)}if(C!==null){v.lab.a=A(C)}if(B!==null){v.lab.b=A(B)}return this};this.setCMYK=function(E,B,D,C){v={cmyk:this.getCMYK()};if(E!==null){v.cmyk.c=A(E)}if(B!==null){v.cmyk.m=A(B)}if(D!==null){v.cmyk.y=A(D)}if(C!==null){v.cmyk.k=A(C)}return this};this.getRGB=function(){if(!v.rgb){v.rgb=v.lab?o(q(v.lab)):v.hsv?x(v.hsv):v.hsl?u(v.hsl):v.cmyk?t(m(v.cmyk)):{r:0,g:0,b:0};v.rgb.r=A(v.rgb.r);v.rgb.g=A(v.rgb.g);v.rgb.b=A(v.rgb.b)}return b.extend({},v.rgb)};this.getHSV=function(){if(!v.hsv){v.hsv=v.lab?l(this.getRGB()):v.rgb?l(v.rgb):v.hsl?l(this.getRGB()):v.cmyk?l(this.getRGB()):{h:0,s:0,v:0};v.hsv.h=A(v.hsv.h);v.hsv.s=A(v.hsv.s);v.hsv.v=A(v.hsv.v)}return b.extend({},v.hsv)};this.getHSL=function(){if(!v.hsl){v.hsl=v.rgb?s(v.rgb):v.hsv?s(this.getRGB()):v.cmyk?s(this.getRGB()):v.hsv?s(this.getRGB()):{h:0,s:0,l:0};v.hsl.h=A(v.hsl.h);v.hsl.s=A(v.hsl.s);v.hsl.l=A(v.hsl.l)}return b.extend({},v.hsl)};this.getCMYK=function(){if(!v.cmyk){v.cmyk=v.rgb?n(z(v.rgb)):v.hsv?n(z(this.getRGB())):v.hsl?n(z(this.getRGB())):v.lab?n(z(this.getRGB())):{c:0,m:0,y:0,k:1};v.cmyk.c=A(v.cmyk.c);v.cmyk.m=A(v.cmyk.m);v.cmyk.y=A(v.cmyk.y);v.cmyk.k=A(v.cmyk.k)}return b.extend({},v.cmyk)};this.getLAB=function(){if(!v.lab){v.lab=v.rgb?k(p(v.rgb)):v.hsv?k(p(this.getRGB())):v.hsl?k(p(this.getRGB())):v.cmyk?k(p(this.getRGB())):{l:0,a:0,b:0};v.lab.l=A(v.lab.l);v.lab.a=A(v.lab.a);v.lab.b=A(v.lab.b)}return b.extend({},v.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return b.extend(true,{},v)};this.setSpaces=function(B){v=B;return this};this.distance=function(E){var G="lab",C="get"+G.toUpperCase(),D=this[C](),B=E[C](),H=0,F;for(F in D){H+=Math.pow(D[F]-B[F],2)}return H};this.equals=function(D){var C=this.getRGB(),B=D.getRGB();return this.getAlpha()==D.getAlpha()&&C.r==B.r&&C.g==B.g&&C.b==B.b};this.limit=function(B){B-=1;var C=this.getRGB();this.setRGB(Math.round(C.r*B)/B,Math.round(C.g*B)/B,Math.round(C.b*B)/B)};this.toHex=function(){var B=this.getRGB();return r(B.r*255)+r(B.g*255)+r(B.b*255)};this.toCSS=function(){return"#"+this.toHex()};this.normalize=function(){this.setHSV(null,1,1);return this};this.copy=function(){var C=this.getSpaces(),B=this.getAlpha();return new a(C,B)};if(w.length==2){this.setSpaces(w[0]);this.setAlpha(w[1]===0?0:w[1]||1)}if(w.length>2){this.setRGB(w[0],w[1],w[2]);this.setAlpha(w[3]===0?0:w[3]||1)}};b.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:"",altOnChange:true,altProperties:"background-color",autoOpen:false,buttonColorize:false,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:"#00FF00",colorFormat:"HEX",draggable:true,duration:"fast",hsv:true,inline:true,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:false,mode:"h",parts:"",regional:"",rgb:true,showAnim:"fadeIn",showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:"focus",showOptions:{},swatches:null,swatchesWidth:84,title:null,close:null,init:null,select:null,open:null},_create:function(){var k=this,l;++j;k.widgetEventPrefix="color";k.opened=false;k.generated=false;k.inline=false;k.changed=false;k.dialog=null;k.button=null;k.image=null;k.overlay=null;k.mode=k.options.mode;if(this.element[0].nodeName.toLowerCase()==="input"||!k.options.inline){k._setColor(k.element.val());this._callback("init");b("body").append(c);k.dialog=b(".ui-colorpicker:last");b(document).delegate("html","touchstart click",function(n){if(!k.opened||n.target===k.element[0]||k.overlay){return}if(k.dialog.is(n.target)||k.dialog.has(n.target).length>0){k.element.blur();return}var o,m=b(n.target).parents();for(o=0;o<=m.length;++o){if(k.button!==null&&m[o]===k.button[0]){return}}if(!k.options.closeOnOutside){return}k.close()});b(document).keydown(function(m){if(m.keyCode==27&&k.opened&&k.options.closeOnEscape){k.close()}});if(k.options.showOn==="focus"||k.options.showOn==="both"){k.element.on("focus click",function(){k.open()})}if(k.options.showOn==="button"||k.options.showOn==="both"){if(k.options.buttonImage!==""){l=k.options.buttonText||k._getRegional("button");k.image=b("<img/>").attr({src:k.options.buttonImage,alt:l,title:l});k._setImageBackground()}if(k.options.buttonImageOnly&&k.image){k.button=k.image}else{k.button=b('<button type="button"></button>').html(k.image||k.options.buttonText).button();k.image=k.image?b("img",k.button).first():null}k.button.insertAfter(k.element).click(function(){k[k.opened?"close":"open"]()})}if(k.options.autoOpen){k.open()}k.element.keydown(function(m){if(m.keyCode===9){k.close()}}).keyup(function(n){var m=k._parseColor(k.element.val());if(!k.color.equals(m)){k.color=m;k._change()}})}else{k.inline=true;b(this.element).html(d);k.dialog=b(".ui-colorpicker",this.element);k._generate();k.opened=true}return this},_setOption:function(k,m){var l=this;switch(k){case"disabled":if(m){l.dialog.addClass("ui-colorpicker-disabled")}else{l.dialog.removeClass("ui-colorpicker-disabled")}break}b.Widget.prototype._setOption.apply(l,arguments)},_setImageBackground:function(){if(this.image&&this.options.buttonColorize){this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")}},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var k,m,l=this.options.altProperties.split(",");for(k=0;k<=l.length;++k){m=b.trim(l[k]);switch(m){case"color":case"background-color":case"outline-color":case"border-color":b(this.options.altField).css(m,this.color.set?this.color.toCSS():"");break}}if(this.options.altAlpha){b(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}}},_setColor:function(k){this.color=this._parseColor(k);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(k){this._setColor(k);this._change(this.color.set)},_generate:function(){var o=this,m,l,n,k;o._setColor(o.inline?o.options.color:o.element.val());if(typeof o.options.parts==="string"){if(g[o.options.parts]){n=g[o.options.parts]}else{n=g[o.inline?"inline":"popup"]}}else{n=o.options.parts}o.parts={};b.each(n,function(q,p){if(f[p]){o.parts[p]=new f[p](o)}});if(!o.generated){k=[];b.each(o.options.layout,function(p,q){if(o.parts[p]){k.push({part:p,pos:q})}});b(i(k,function(q,p,s){var r=["ui-colorpicker-"+q.part+"-container"];if(p>0){r.push("ui-colorpicker-padding-left")}if(s>0){r.push("ui-colorpicker-padding-top")}return'<td  class="'+r.join(" ")+'"'+(q.pos[2]>1?' colspan="'+q.pos[2]+'"':"")+(q.pos[3]>1?' rowspan="'+q.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(o.dialog).addClass("ui-dialog-content ui-widget-content");o._initAllParts();o._updateAllParts();o.generated=true}},_effectGeneric:function(m,l,k,o,p){var n=this;if(b.effects&&b.effects[n.options.showAnim]){m[l](n.options.showAnim,n.options.showOptions,n.options.duration,p)}else{m[(n.options.showAnim==="slideDown"?k:(n.options.showAnim==="fadeIn"?o:l))]((n.options.showAnim?n.options.duration:null),p);if(!n.options.showAnim||!n.options.duration){p()}}},_effectShow:function(k,l){this._effectGeneric(k,"show","slideDown","fadeIn",l)},_effectHide:function(k,l){this._effectGeneric(k,"hide","slideUp","fadeOut",l)},open:function(){var n=this,m,k,r,s,l,q,p,o;if(!n.opened){n._generate();m=n.element.offset();k=b(window).height()+b(window).scrollTop();r=b(window).width()+b(window).scrollLeft();s=n.dialog.outerHeight();l=n.dialog.outerWidth();q=m.left;p=m.top+n.element.outerHeight();if(q+l>r){q=Math.max(0,r-l)}if(p+s>k){if(m.top-s>=b(window).scrollTop()){p=m.top-s}else{p=Math.max(0,k-s)}}n.dialog.css({left:q,top:p});o=0;b(n.element[0]).parents().each(function(){var t=b(this).css("z-index");if((typeof(t)==="number"||typeof(t)==="string")&&t!==""&&!isNaN(t)){o=parseInt(t);return false}});n.dialog.css("z-index",o+=2);n.overlay=n.options.modal?new b.ui.dialog.overlay(n):null;n._effectShow(this.dialog);n.opened=true;n._callback("open",true);b(function(){n._repaintAllParts()})}},close:function(){var k=this;k.currentColor=k.color.copy();k.changed=false;k._effectHide(k.dialog,function(){k.dialog.empty();k.generated=false;k.opened=false;k._callback("close",true)});if(k.overlay){k.overlay.destroy()}},destroy:function(){this.element.unbind();if(this.image!==null){this.image.remove()}if(this.button!==null){this.button.remove()}if(this.dialog!==null){this.dialog.remove()}if(this.overlay){this.overlay.destroy()}},_callback:function(o,k){var m=this,n,l;if(m.color.set){n={formatted:m._formatColor(m.options.colorFormat,m.color)};l=m.color.getLAB();l.a=(l.a*2)-1;l.b=(l.b*2)-1;if(k===true){n.a=m.color.getAlpha();n.rgb=m.color.getRGB();n.hsv=m.color.getHSV();n.cmyk=m.color.getCMYK();n.hsl=m.color.getHSL();n.lab=l}return m._trigger(o,null,n)}else{return m._trigger(o,null,{formatted:""})}},_initAllParts:function(){b.each(this.parts,function(l,k){if(k.init){k.init()}})},_updateAllParts:function(){b.each(this.parts,function(l,k){if(k.update){k.update()}})},_repaintAllParts:function(){b.each(this.parts,function(l,k){if(k.repaint){k.repaint()}})},_change:function(l){this.color.set=(l!==false);this.changed=true;switch(this.options.limit){case"websafe":this.color.limit(6);break;case"nibble":this.color.limit(16);break;case"binary":this.color.limit(2);break;case"name":var k=this._getSwatch(this._closestName(this.color));this.color.setRGB(k.r,k.g,k.b);break}if(!this.inline){if(!this.color.set){this.element.val("")}else{if(!this.color.equals(this._parseColor(this.element.val()))){this.element.val(this._formatColor(this.options.colorFormat,this.color))}}this._setImageBackground();this._setAltField()}if(this.opened){this._repaintAllParts()}this._callback("select")},_hoverable:function(k){k.hover(function(){k.addClass("ui-state-hover")},function(){k.removeClass("ui-state-hover")})},_focusable:function(k){k.focus(function(){k.addClass("ui-state-focus")}).blur(function(){k.removeClass("ui-state-focus")})},_getRegional:function(k){return b.colorpicker.regional[this.options.regional][k]!==undefined?b.colorpicker.regional[this.options.regional][k]:b.colorpicker.regional[""][k]},_getSwatches:function(){if(typeof(this.options.swatches)==="string"){return b.colorpicker.swatches[this.options.swatches]}if(b.isPlainObject(this.options.swatches)){return b.colorpicker.swatches}return b.colorpicker.swatches.html},_getSwatch:function(l){var k=this._getSwatches(),m=false;if(k[l]!==undefined){return k[l]}b.each(k,function(n,o){if(n.toLowerCase()==l.toLowerCase()){m=o;return false}return true});return m},_parseColor:function(l){var n,k;if(l==""){return new a()}n=this._getSwatch(b.trim(l));if(n){return new a(n.r,n.g,n.b)}k=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(l);if(k){return new a(k[1]/255,k[2]/255,k[3]/255,parseFloat(k[4]))}k=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(l);if(k){return(new a()).setHSL(k[1]/255,k[2]/255,k[3]/255).setAlpha(parseFloat(k[4]))}k=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(l);if(k){return new a(k[1]/100,k[2]/100,k[3]/100,k[4]/100)}k=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(l);if(k){return(new a()).setHSL(k[1]/100,k[2]/100,k[3]/100).setAlpha(k[4]/100)}k=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(l);if(k){return new a(parseInt(k[1],16)/255,parseInt(k[2],16)/255,parseInt(k[3],16)/255)}k=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(l);if(k){return new a(parseInt(k[1]+k[1],16)/255,parseInt(k[2]+k[2],16)/255,parseInt(k[3]+k[3],16)/255)}return e(l)},_exactName:function(k){var l=false;b.each(this._getSwatches(),function(o,m){if(k.equals(new a(m.r,m.g,m.b))){l=o;return false}return true});return l},_closestName:function(k){var m=k.getRGB(),o=null,l=false,n;b.each(this._getSwatches(),function(q,p){n=k.distance(new a(p.r,p.g,p.b));if(n<o||o===null){l=q;if(n==0){return false}o=n}return true});return l},_formatColor:function(l,m){var o=this,p=null,n={x:function(q){return h(q*255)},d:function(q){return Math.round(q*255)},f:function(q){return q},p:function(q){return q*100}},k=m.getChannels();if(!b.isArray(l)){l=[l]}b.each(l,function(q,r){if(o._formats[r]){p=o._formats[r](m,o);return(p===false)}else{p=r.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(s){if(s.match(/^\\/)){return s.slice(1)}return n[s.charAt(1)](k[s.charAt(0)])});return false}});return p},_formats:{"#HEX":function(k,l){return l._formatColor("#rxgxbx",k)},"#HEX3":function(l,m){var k=m._formats.HEX3(l);return k===false?false:"#"+k},HEX:function(k,l){return l._formatColor("rxgxbx",k)},HEX3:function(l,p){var m=l.getRGB(),o=Math.round(m.r*255),n=Math.round(m.g*255),k=Math.round(m.b*255);if(((o>>>4)==(o&=15))&&((n>>>4)==(n&=15))&&((k>>>4)==(k&=15))){return o.toString(16)+n.toString(16)+k.toString(16)}return false},RGB:function(k,l){return k.getAlpha()>=1?l._formatColor("rgb(rd,gd,bd)",k):false},RGBA:function(k,l){return l._formatColor("rgba(rd,gd,bd,af)",k)},"RGB%":function(k,l){return k.getAlpha()>=1?l._formatColor("rgb(rp%,gp%,bp%)",k):false},"RGBA%":function(k,l){return l._formatColor("rgba(rp%,gp%,bp%,af)",k)},HSL:function(k,l){return k.getAlpha()>=1?l._formatColor("hsl(hd,sd,vd)",k):false},HSLA:function(k,l){return l._formatColor("hsla(hd,sd,vd,af)",k)},"HSL%":function(k,l){return k.getAlpha()>=1?l._formatColor("hsl(hp%,sp%,vp%)",k):false},"HSLA%":function(k,l){return l._formatColor("hsla(hp%,sp%,vp%,af)",k)},NAME:function(k,l){return l._closestName(k)},EXACT:function(k,l){return l._exactName(k)}}})}(jQuery));