function submitOnKey(a){if(a==37){system=system>1?parseInt(system)-1:maxSystems;loadContent(galaxy,system,true)}else{if(a==39){system=system<maxSystems?parseInt(system)+1:1;loadContent(galaxy,system,true)}else{if(a==40){galaxy=galaxy>1?parseInt(galaxy)-1:maxGalaxies;loadContent(galaxy,system,true)}else{if(a==38){galaxy=galaxy<maxGalaxies?parseInt(galaxy)+1:1;loadContent(galaxy,system,true)}}}}}function keyevent(a){var b;if($(":focus").closest(".ui-dialog").length){return true}if($(":focus").closest(".chat_box_textarea").length){return true}if(window.event){b=window.event.keyCode}else{if(a){b=a.which}else{return true}}submitOnKey(b)}function launchMissiles(a){var a=$.parseJSON(a);if(a.status){$("#missileValue").html(a.rockets);getAjaxEventbox()}errorBoxAsArray(a.errorbox);$("#rocketattack").closest(".ui-dialog-content").dialog("close")}function errorBoxSubmitYes(){location.href=officersLink}function movePlanet(b,a){function c(){$.post(b,function(d){if((d=="")||(d==null)){fadeBox(galaxyLoca.reservationSuccess,false);setTimeout('reload_page("'+a+'")',3000)}else{fadeBox(d,true)}})}errorBoxDecision(galaxyLoca.questionTitle,galaxyLoca.question,LocalizationStrings.yes,LocalizationStrings.no,c)}function addToTable(g,d,h){var i=g;if(h!=null){i+=" ("+tsdpkt(h)+") "+LocalizationStrings.ok}if(isMobile){fadeBox(i,d!="success");return}var c=new Date();var b="fleetstatus"+c.getTime();var f='id="'+b+'"';var e='class="'+d+'"';var a="<div "+f+" "+e+">"+i+"</div>";if($("#fleetstatusrow").has("div").length){$("#fleetstatusrow").empty()}$(a).prependTo("#fleetstatusrow").fadeOut(3000,function(){$(this).remove()})}function setShips(b,a){var c=document.getElementById(b);c.innerHTML=a}function displayContentGalaxy(b){var a=$.parseJSON(b);$("#galaxyContent").html(a.galaxy);$("galaxyContent").find("script").each(function(){$.globalEval($(this).text())});tabletInitGalaxyDetails();eventBDayInitGalaxy();$("#galaxyLoading").hide();if(preserveSystemOnPlanetChange){$(".planetlink, .moonlink").querystring({galaxy:galaxy,system:system})}reloadResources(a.resources);displayDebrisAtExpeditionSlot(a)}function displayDebrisAtExpeditionSlot(b){var a=b.debrisAtExpeditionSlot||"";$("#debrisAtExpeditionSlot").html(a)}function submitForm(){galaxy=$("#galaxy_input").val();system=$("#system_input").val();if(0===galaxy.length||!$.isNumeric(+galaxy)){galaxy=1}if(0===system.length||!$.isNumeric(+system)){system=1}loadContent(galaxy,system,true)}function loadContent(c,b,a){$("#galaxyLoading").show();if(0===c.length||!$.isNumeric(+c)){c=1}if(0===b.length||!$.isNumeric(+b)){b=1}$("#galaxy_input").val(c);$("#system_input").val(b);$.post(contentLink,{galaxy:c,system:b},displayContentGalaxy)}function errorBoxDeuterium(){fadeBox(galaxyLoca.deuteriumNeeded,true)}function doScan(a,b){sendShips(constants.espionage,galaxy,system,a,b,spionageAmount)}function initPhalanx(){getAjaxResourcebox();$(".eventFleet:odd").addClass("odd");$(".partnerInfo:even").addClass("part-even");$(".toggleInfos").click(function(){id=$(this).attr("rel");if($(this).attr("class")=="toggleInfos infosOpen"){$(this).removeClass("infosOpen");$(this).addClass("infosClosed");$(this).children().attr("src","//gf2.geo.gfsrv.net/cdn10/de1e5f629d9e47d283488eee0c0ede.gif");$("."+id).attr("style","display: none;")}else{$(this).addClass("infosOpen");$(this).removeClass("infosClosed");$(this).children().attr("src","//gf3.geo.gfsrv.net/cdnb6/577565fadab7780b0997a76d0dca9b.gif");$("."+id).attr("style","display: block;")}});var a=$(".overlayDiv.phalanx").siblings(".ui-dialog-titlebar");if(a.find(".refreshPhalanxLink").length){$("#phalanxWrap .refreshPhalanxLink").remove()}else{a.find(".ui-dialog-title").append($("#phalanxWrap .refreshPhalanxLink"))}}function initMissleAttackLayer(){$("#rocketattack").closest(".ui-dialog-content").dialog("option","title",$("#rocketattack").data("title"));$("#rocketattack input#missileCount").keyup(function(){checkIntInput($(this),1,$(this).data("max"))}).change(function(){checkIntInput($(this),1,$(this).data("max"))}).focus();$("#rocketattack #number").bind("click",function(){var b=$("#rocketattack input#missileCount");if(parseInt(b.val())!=b.data("max")){b.val(b.data("max"))}else{b.val("1")}});$("#rocketattack #priority a").bind("click",function(){var c=$(this);var b=$("#primaryTarget");$("#rocketattack #priority a").not(c).removeClass("active");if(c.hasClass("active")){c.removeClass("active");b.val("");$("#noPriorityInfo").show()}else{c.addClass("active");b.val(c.attr("ref"));$("#noPriorityInfo").hide()}});$("form#rocketForm").submit(function(){ajaxFormSubmit("rocketForm",$(this).attr("action"),launchMissiles);return false});function a(){var b=$("#rocketattack #arrivalTime #timer");b.html(getFormatedDate(serverTime.getTime()+1000*b.data("duration"),"[d].[m].[y] [G]:[i]:[s]"))}timerHandler.appendCallback(a);a()}function displayMiniFleetMessage(b){var c=b.message;if(typeof(b.coordinates)!="undefined"){c+=" ["+b.coordinates.galaxy+":"+b.coordinates.system+":"+b.coordinates.position+"]"}if(b.success){var a="#ownFleetStatus_"+b.coordinates.position+"_"+b.planetType;switch(b.type){case 1:$(a).removeClass("fleetNeutral");$(a).attr("title",galaxyLoca.fleetAttacking).addClass("fleetHostile").addClass("tooltip");break;case 2:$(a).attr("title",galaxyLoca.fleetUnderway).addClass("fleetNeutral").addClass("tooltip");break}addToTable(c,"success",b.shipsSent);$("#slotUsed").html(tsdpkt(b.slots));setShips("probeValue",tsdpkt(b.probes));setShips("recyclerValue",tsdpkt(b.recyclers));setShips("missileValue",tsdpkt(b.missiles))}else{addToTable(c,"error")}shipsendingDone=1}function filterToggle(b){var a=b.target;var c;switch(a.id){case"filter_empty":c=".empty_filter";break;case"filter_inactive":c=".inactive_filter";break;case"filter_vacation":c=".vacation_filter";break;case"filter_strong":c=".strong_filter";break;case"filter_newbie":c=".newbie_filter";break}a=$(a);if(a.hasClass("filter_active")){a.removeClass("filter_active");$(c).each(function(d,e){$(this).removeClass("filtered_"+$(b.target)[0].id)});sendFilterToggle($(b.target)[0].id,0);b.stopPropagation()}else{a.addClass("filter_active");$(c).each(function(d,e){$(this).addClass("filtered_"+$(b.target)[0].id)});sendFilterToggle($(b.target)[0].id,1);b.stopPropagation()}}function sendFilterToggle(b,a){$.ajax({type:"POST",url:"?page=togglefilter",dataType:"json",data:{id:b,state:a},success:function(c){},error:function(){}})};